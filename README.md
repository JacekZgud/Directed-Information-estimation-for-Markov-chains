
<!-- README.md is generated from README.Rmd. Please edit that file -->

# Markov.dir.info

<!-- badges: start -->
<!-- badges: end -->

The goal of this collection is to simulate the specific class of Markov
chains and calculate relevant information theory-based measures. The
code is oriented around `MarkovProcess` S4 class object. \##
Installation

You can install the development version of Markov.dir.info like so:

``` r
install_github("JacekZgud/Directed-Information-estimation-for-Markov-chains")
```

### Comparison to Ay Polani information flow using an example from their article.

Script for it may be found in `mutual_info_comparison.R` followed by
some other visualisations.

## Example

This is a basic example which shows you how to use the library:

\<\<\<\<\<\<\< HEAD

``` r
library(Markov.dir.info)

# parametrise the code
node_dim = 3
nodes = 3
work_names = tail(LETTERS, nodes)

# define parent structure
ParentStructure = matrix(nrow = nodes, ncol = nodes, data = 0)
rownames(ParentStructure) = colnames(ParentStructure) = work_names

# define the parent structure of nodes
diag(ParentStructure) = 1
ParentStructure[2, 3] = 1
ParentStructure[3, 2] = 1
ParentStructure[1, 2] = 1
ParentStructure[2, 1] = 1

#------------------------------------------------------------------------
# initialize Markov Process class 
process = MarkovProcess(node_dim, nodes, ParentStructure, work_names)
process@trans_prob
#> $X
#>    X Y     prob_0    prob_1      prob_2
#> 1: 0 0 0.23012987 0.4597403 0.310129870
#> 2: 0 1 0.29111438 0.4241532 0.284732450
#> 3: 0 2 0.28099839 0.2455717 0.473429952
#> 4: 1 0 0.69281046 0.2992012 0.007988381
#> 5: 1 1 0.54204309 0.1209173 0.337039611
#> 6: 1 2 0.09326425 0.3461140 0.560621762
#> 7: 2 0 0.33901705 0.3450351 0.315947844
#> 8: 2 1 0.23846154 0.2214286 0.540109890
#> 9: 2 2 0.23249300 0.4374416 0.330065359
#> 
#> $Y
#>     X Y Z     prob_0     prob_1     prob_2
#>  1: 0 0 0 0.30749487 0.46919918 0.22330595
#>  2: 0 0 1 0.22381930 0.45841889 0.31776181
#>  3: 0 0 2 0.11964549 0.04726736 0.83308715
#>  4: 0 1 0 0.30657956 0.44143724 0.25198320
#>  5: 0 1 1 0.30134814 0.35567010 0.34298176
#>  6: 0 1 2 0.62258953 0.21671258 0.16069789
#>  7: 0 2 0 0.49826389 0.18518519 0.31655093
#>  8: 0 2 1 0.37732919 0.46040373 0.16226708
#>  9: 0 2 2 0.06500000 0.54666667 0.38833333
#> 10: 1 0 0 0.28395752 0.51145892 0.20458357
#> 11: 1 0 1 0.02034261 0.84154176 0.13811563
#> 12: 1 0 2 0.28370044 0.50396476 0.21233480
#> 13: 1 1 0 0.22437532 0.28352881 0.49209587
#> 14: 1 1 1 0.18142549 0.51565875 0.30291577
#> 15: 1 1 2 0.29172932 0.31879699 0.38947368
#> 16: 1 2 0 0.66989247 0.09892473 0.23118280
#> 17: 1 2 1 0.09335727 0.85996409 0.04667864
#> 18: 1 2 2 0.43548387 0.18817204 0.37634409
#> 19: 2 0 0 0.35932626 0.46600125 0.17467249
#> 20: 2 0 1 0.33746898 0.44665012 0.21588089
#> 21: 2 0 2 0.46006067 0.45500506 0.08493428
#> 22: 2 1 0 0.09909910 0.87837838 0.02252252
#> 23: 2 1 1 0.34338843 0.25454545 0.40206612
#> 24: 2 1 2 0.29229711 0.37207703 0.33562586
#> 25: 2 2 0 0.15484180 0.42042186 0.42473634
#> 26: 2 2 1 0.30671506 0.55898367 0.13430127
#> 27: 2 2 2 0.45301543 0.48948107 0.05750351
#>     X Y Z     prob_0     prob_1     prob_2
#> 
#> $Z
#>    Y Z     prob_0    prob_1      prob_2
#> 1: 0 0 0.37354283 0.2498733 0.376583882
#> 2: 0 1 0.29946524 0.3491215 0.351413293
#> 3: 0 2 0.15121951 0.4261641 0.422616408
#> 4: 1 0 0.16056671 0.8311688 0.008264463
#> 5: 1 1 0.04042553 0.5815603 0.378014184
#> 6: 1 2 0.37267081 0.5714286 0.055900621
#> 7: 2 0 0.39890710 0.2597730 0.341319882
#> 8: 2 1 0.46131805 0.1840974 0.354584527
#> 9: 2 2 0.12105007 0.3957219 0.483228002

# example of quick manual conditional probability changes:

process2 = MarkovProcess(node_dim, nodes, ParentStructure, work_names)
process2@trans_prob$X$prob_0 = c(0.05, 0.05, 0.90, 0.90, 0.05, 0.05, 0.90, 0.90, 0.1)
process2@trans_prob$X$prob_1 = c(0.90, 0.90, 0.05, 0.05, 0.90, 0.90, 0.05, 0.05, 0.1)
process2@trans_prob$X$prob_2 = 1 - process@trans_prob$X$prob_1 -  process@trans_prob$X$prob_0
process2@trans_prob$X
#>    X Y prob_0 prob_1      prob_2
#> 1: 0 0   0.05   0.90 0.310129870
#> 2: 0 1   0.05   0.90 0.284732450
#> 3: 0 2   0.90   0.05 0.473429952
#> 4: 1 0   0.90   0.05 0.007988381
#> 5: 1 1   0.05   0.90 0.337039611
#> 6: 1 2   0.05   0.90 0.560621762
#> 7: 2 0   0.90   0.05 0.315947844
#> 8: 2 1   0.90   0.05 0.540109890
#> 9: 2 2   0.10   0.10 0.330065359



#------------------------------------------------------------------------
# transition matrix

process = stationary.probability(process)

process = trans.matrix(process)

#------------------------------------------------------------------------
#markov process simulation

m = 10 

process = simulate(process, m)
process@simulation
#>       X Y Z
#>  [1,] 1 1 0
#>  [2,] 1 0 1
#>  [3,] 0 1 0
#>  [4,] 1 1 1
#>  [5,] 0 2 2
#>  [6,] 2 2 1
#>  [7,] 1 1 2
#>  [8,] 1 0 0
#>  [9,] 0 2 1
#> [10,] 2 0 0

#-------------------------------------------------------------------------
# simulate marginalized markov process
n_2 = 10 

process = simulate.marginalized(process, c('Y', 'Z'), n_2)

process@marg_sim
#> $sim_target
#>       Y Z
#>  [1,] 0 2
#>  [2,] 0 2
#>  [3,] 2 2
#>  [4,] 0 2
#>  [5,] 1 0
#>  [6,] 0 1
#>  [7,] 2 2
#>  [8,] 1 1
#>  [9,] 2 1
#> [10,] 2 1
#> 
#> $ft
#>      X         1         2         3         4         5         6         7
#> [1,] 0 0.1622059 0.4280988 0.3092280 0.1555976 0.4994204 0.3627469 0.3522629
#> [2,] 1 0.3288832 0.3391235 0.4289035 0.3731895 0.3260602 0.3186759 0.3941651
#> [3,] 2 0.5089109 0.2327777 0.2618684 0.4712129 0.1745195 0.3185773 0.2535720
#>              8         9        10
#> [1,] 0.2299703 0.3341760 0.2412938
#> [2,] 0.3255798 0.2384901 0.3443987
#> [3,] 0.4444499 0.4273338 0.4143076
#> 
#> $mt
#>   Y Z          1          2          3          4          5           6
#> 1 0 0 0.17922503 0.05244919 0.03848861 0.03940311 0.05160776 0.039108696
#> 2 0 1 0.11671345 0.14781135 0.10846789 0.12881178 0.14544004 0.202445013
#> 3 0 2 0.15335166 0.14658087 0.10756493 0.15729595 0.14422930 0.002012948
#> 4 1 0 0.09229568 0.06123931 0.04492072 0.04574869 0.06197479 0.074856892
#> 5 1 1 0.06010404 0.17258351 0.12659477 0.14955596 0.17465622 0.387494502
#> 6 1 2 0.07897165 0.17114681 0.12554091 0.18262730 0.17320227 0.003852928
#> 7 2 0 0.12738639 0.03753101 0.06781018 0.03589827 0.03763697 0.046601118
#> 8 2 1 0.08295552 0.10576922 0.19110142 0.11735419 0.10606782 0.241229316
#> 9 2 2 0.10899658 0.10488873 0.18951056 0.14330475 0.10518484 0.002398587
#>            7          8          9         10
#> 1 0.05845034 0.03745551 0.01135911 0.12890559
#> 2 0.06814236 0.12244494 0.16341178 0.05144214
#> 3 0.06858969 0.14952121 0.10621766 0.09908116
#> 4 0.17272006 0.04731362 0.01466696 0.27578584
#> 5 0.20135987 0.15467184 0.21099840 0.11005739
#> 6 0.20268171 0.18887446 0.13714896 0.21197825
#> 7 0.06829483 0.03628094 0.01439946 0.05662662
#> 8 0.07961923 0.11860515 0.20715010 0.02259789
#> 9 0.08014190 0.14483233 0.13464756 0.04352512
#> 
#> $target_name
#> [1] "Y" "Z"
#> 
#> $sim_length
#> [1] 10
#calculate transfer entropy from V/target -----> target
process = trans_entropy(process, c('Y', 'Z'), sim.length = n_2)

process@trans_entropy_table
#>   target origin transfer.entropy
#> 1      Y      X        0.1745222
#> 2      Z      X        0.1745222
```
