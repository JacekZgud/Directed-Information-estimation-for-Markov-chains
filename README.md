
<!-- README.md is generated from README.Rmd. Please edit that file -->

# Markov.dir.info

<!-- badges: start -->
<!-- badges: end -->

The goal of this collection is to simulate the specific class of Markov
chains and calculate relevant information theory-based measures. The
code is oriented around `MarkovProcess` S4 class object.

## Installation

You can install the development version of `Markov.dir.info like` so:

``` r
install_github("JacekZgud/Directed-Information-estimation-for-Markov-chains")
```

### Comparison to Ay Polani information flow using an example from their article.

Script for it may be found in `mutual_info_comparison.R` followed by
some other visualisations.

## Example

This is a basic example which shows you how to use the library:

``` r
library(Markov.dir.info)

# parametrise the code
node_dim = 3
nodes = 3
work_names = tail(LETTERS, nodes)

# define parent structure
ParentStructure = matrix(nrow = nodes, ncol = nodes, data = 0)
rownames(ParentStructure) = colnames(ParentStructure) = work_names

# define the parent structure of nodes
diag(ParentStructure) = 1
ParentStructure[2, 3] = 1
ParentStructure[3, 2] = 1
ParentStructure[1, 2] = 1
ParentStructure[2, 1] = 1

#------------------------------------------------------------------------
# initialize Markov Process class 
process = MarkovProcess(node_dim, nodes, ParentStructure, work_names)
process@trans_prob
#> $X
#>    X Y     prob_0      prob_1    prob_2
#> 1: 0 0 0.06647673 0.070275404 0.8632479
#> 2: 0 1 0.36679245 0.329056604 0.3041509
#> 3: 0 2 0.20670103 0.500515464 0.2927835
#> 4: 1 0 0.51066098 0.178571429 0.3107676
#> 5: 1 1 0.11285008 0.464579901 0.4225700
#> 6: 1 2 0.32752992 0.007616975 0.6648531
#> 7: 2 0 0.57555178 0.060271647 0.3641766
#> 8: 2 1 0.39956012 0.296187683 0.3042522
#> 9: 2 2 0.63039867 0.183554817 0.1860465
#> 
#> $Y
#>     X Y Z     prob_0    prob_1      prob_2
#>  1: 0 0 0 0.09090909 0.6340909 0.275000000
#>  2: 0 0 1 0.08040201 0.3517588 0.567839196
#>  3: 0 0 2 0.41869651 0.1316656 0.449637920
#>  4: 0 1 0 0.51696751 0.1711191 0.311913357
#>  5: 0 1 1 0.01881331 0.4761216 0.505065123
#>  6: 0 1 2 0.07204611 0.4214697 0.506484150
#>  7: 0 2 0 0.88090737 0.1124764 0.006616257
#>  8: 0 2 1 0.53100499 0.1981468 0.270848182
#>  9: 0 2 2 0.42417172 0.2468502 0.328978068
#> 10: 1 0 0 0.28231293 0.3412698 0.376417234
#> 11: 1 0 1 0.12032086 0.2121212 0.667557932
#> 12: 1 0 2 0.30721966 0.2913466 0.401433692
#> 13: 1 1 0 0.50602410 0.4563253 0.037650602
#> 14: 1 1 1 0.06262105 0.5919948 0.345384119
#> 15: 1 1 2 0.36186950 0.4363720 0.201758445
#> 16: 1 2 0 0.54353393 0.4039693 0.052496799
#> 17: 1 2 1 0.01534356 0.5983989 0.386257505
#> 18: 1 2 2 0.29078744 0.2501287 0.459083891
#> 19: 2 0 0 0.50331925 0.1635486 0.333132167
#> 20: 2 0 1 0.51467710 0.2067841 0.278538813
#> 21: 2 0 2 0.24304539 0.6076135 0.149341142
#> 22: 2 1 0 0.35479951 0.3223977 0.322802754
#> 23: 2 1 1 0.18878101 0.2729234 0.538295577
#> 24: 2 1 2 0.17317612 0.3043478 0.522476050
#> 25: 2 2 0 0.26730104 0.2352941 0.497404844
#> 26: 2 2 1 0.19548872 0.5235817 0.280929597
#> 27: 2 2 2 0.27750309 0.2527812 0.469715698
#>     X Y Z     prob_0    prob_1      prob_2
#> 
#> $Z
#>    Y Z     prob_0    prob_1     prob_2
#> 1: 0 0 0.18534483 0.3750000 0.43965517
#> 2: 0 1 0.08063103 0.4005259 0.51884312
#> 3: 0 2 0.62899628 0.3591078 0.01189591
#> 4: 1 0 0.60360360 0.3310811 0.06531532
#> 5: 1 1 0.26607717 0.3758039 0.35811897
#> 6: 1 2 0.31415150 0.1426894 0.54315913
#> 7: 2 0 0.24045802 0.2847328 0.47480916
#> 8: 2 1 0.51225344 0.0376569 0.45008966
#> 9: 2 2 0.08228195 0.4975315 0.42018651

# example of quick manual conditional probability changes:

process2 = MarkovProcess(node_dim, nodes, ParentStructure, work_names)
process2@trans_prob$X$prob_0 = c(0.05, 0.05, 0.90, 0.90, 0.05, 0.05, 0.90, 0.90, 0.1)
process2@trans_prob$X$prob_1 = c(0.90, 0.90, 0.05, 0.05, 0.90, 0.90, 0.05, 0.05, 0.1)
process2@trans_prob$X$prob_2 = 1 - process@trans_prob$X$prob_1 -  process@trans_prob$X$prob_0
process2@trans_prob$X
#>    X Y prob_0 prob_1    prob_2
#> 1: 0 0   0.05   0.90 0.8632479
#> 2: 0 1   0.05   0.90 0.3041509
#> 3: 0 2   0.90   0.05 0.2927835
#> 4: 1 0   0.90   0.05 0.3107676
#> 5: 1 1   0.05   0.90 0.4225700
#> 6: 1 2   0.05   0.90 0.6648531
#> 7: 2 0   0.90   0.05 0.3641766
#> 8: 2 1   0.90   0.05 0.3042522
#> 9: 2 2   0.10   0.10 0.1860465



#------------------------------------------------------------------------
# transition matrix

process = stationary.probability(process)

process = trans.matrix(process)

#------------------------------------------------------------------------
#markov process simulation

m = 10 

process = simulate(process, m)
process@simulation
#>       X Y Z
#>  [1,] 2 1 1
#>  [2,] 1 1 0
#>  [3,] 1 1 1
#>  [4,] 1 1 0
#>  [5,] 1 1 1
#>  [6,] 1 1 2
#>  [7,] 2 1 2
#>  [8,] 2 1 1
#>  [9,] 2 2 2
#> [10,] 1 2 1

#-------------------------------------------------------------------------
# simulate marginalized markov process
n_2 = 10 

process = simulate.marginalized(process, c('Y', 'Z'), n_2)

process@marg_sim
#> $sim_target
#>       Y Z
#>  [1,] 2 1
#>  [2,] 0 0
#>  [3,] 1 0
#>  [4,] 2 1
#>  [5,] 1 2
#>  [6,] 2 2
#>  [7,] 0 0
#>  [8,] 0 2
#>  [9,] 1 1
#> [10,] 2 2
#> 
#> $ft
#>      X         1         2         3         4         5         6         7
#> [1,] 0 0.5581719 0.2750402 0.3105519 0.3842403 0.4207720 0.3640827 0.3502487
#> [2,] 1 0.1520173 0.4467504 0.1133943 0.3097821 0.1634415 0.3232909 0.2802430
#> [3,] 2 0.2898108 0.2782095 0.5760539 0.3059776 0.4157865 0.3126265 0.3695082
#>               8          9        10
#> [1,] 0.50367383 0.47063737 0.3703013
#> [2,] 0.09286422 0.07168628 0.3197366
#> [3,] 0.40346195 0.45767634 0.3099622
#> 
#> $mt
#>   Y Z          1          2          3          4          5          6
#> 1 0 0 0.14549716 0.18204427 0.05396412 0.25490729 0.13759221 0.05072409
#> 2 0 1 0.17228711 0.01338248 0.10918321 0.13981855 0.01011471 0.02303916
#> 3 0 2 0.28729915 0.15995255 0.12800791 0.02758325 0.12089491 0.08770052
#> 4 1 0 0.06630808 0.18098252 0.06901568 0.17540992 0.21602422 0.11787205
#> 5 1 1 0.07851719 0.01330443 0.13963637 0.09621365 0.01588043 0.05353815
#> 6 1 2 0.13093215 0.15901965 0.16371161 0.01898092 0.18980891 0.20379748
#> 7 2 0 0.02865278 0.14922665 0.06236503 0.17328639 0.15863701 0.14555536
#> 8 2 1 0.03392853 0.01096999 0.12618041 0.09504888 0.01166176 0.06611206
#> 9 2 2 0.05657787 0.13111746 0.14793566 0.01875114 0.13938584 0.25166113
#>            7          8           9         10
#> 1 0.02758069 0.05503585 0.212270995 0.02653958
#> 2 0.16677123 0.11135161 0.121190178 0.03748415
#> 3 0.14084538 0.13055016 0.004014581 0.03572019
#> 4 0.02055109 0.07009011 0.212928512 0.10415035
#> 5 0.12426561 0.14181022 0.121565569 0.14710057
#> 6 0.10494759 0.16626026 0.004027017 0.14017819
#> 7 0.03415017 0.06021887 0.203796775 0.13538724
#> 8 0.20649470 0.12183817 0.116352059 0.19121914
#> 9 0.17439354 0.14284475 0.003854313 0.18222059
#> 
#> $target_name
#> [1] "Y" "Z"
#> 
#> $sim_length
#> [1] 10
#calculate transfer entropy from V/target -----> target
process = trans_entropy(process, c('Y', 'Z'), sim.length = n_2)

process@trans_entropy_table
#>   target origin transfer.entropy
#> 1   Y, Z      X        0.1474017
```
